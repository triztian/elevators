(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,function(e,t,o){e.exports=o(23)},,,,,,function(e,t,o){},function(e,t,o){},,function(e,t,o){},function(e,t,o){},function(e,t,o){},function(e,t,o){},function(e,t,o){},function(e,t,o){"use strict";o.r(t);var r=o(0),n=o.n(r),a=o(5),c=o.n(a),l=(o(15),o(8)),u=o(1),s=(o(16),o(2)),i=o.n(s),m=o(3),f=o(6),v=o(7),b=new(function(){function e(){Object(f.a)(this,e)}return Object(v.a)(e,[{key:"listFloors",value:function(){var e=Object(m.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"https://mcmelevators.herokuapp.com/floors",e.abrupt("return",fetch("https://mcmelevators.herokuapp.com/floors",{mode:"cors"}).then(function(e){return e.json()}));case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"getElevator",value:function(){var e=Object(m.a)(i.a.mark(function e(t){var o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o="https://mcmelevators.herokuapp.com/elevator/".concat(t),e.abrupt("return",fetch(o,{mode:"cors"}).then(function(e){return e.json()}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"callElevator",value:function(){var e=Object(m.a)(i.a.mark(function e(t,o){var r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Number.isInteger(parseInt(t))){e.next=2;break}return e.abrupt("return",new Error("from argument must be a valid number"));case 2:return r="https://mcmelevators.herokuapp.com/floor/".concat(t),null!==o&&void 0!==o&&Number.isInteger(parseInt(o))&&(r+="/to/".concat(o)),e.abrupt("return",fetch(r,{method:"POST",mode:"cors"}).then(function(e){return e.json()}));case 5:case"end":return e.stop()}},e)}));return function(t,o){return e.apply(this,arguments)}}()},{key:"watchElevator",value:function(e,t){var o=e;e.startsWith("E")&&(o=e.substring(1));var r="wss://mcmelevators.herokuapp.com/elevator/".concat(o,"/updates");return new Promise(function(e,n){var a=new WebSocket(r,"*"),c=function(){a.close()};a.onopen=function(){e(c)},a.onerror=function(e){n(e)},a.onmessage=function(e){var r=JSON.parse(e.data);console.log("api.watchElevator",r),"E".concat(o)===r.id&&t(r)}})}}]),e}());o(18);function E(e){return n.a.createElement("div",{className:"CallButton"},n.a.createElement("button",{type:"button",value:e.floorNumber,onClick:function(t){e.onCallElevator(t.target.value)}},"Call"))}o(19);function d(e){var t=Object(r.useState)(e.selectedFloor),o=Object(u.a)(t,2),a=o[0],c=o[1];return n.a.createElement("div",{className:"FloorSelector"},n.a.createElement("label",{htmlFor:"FS".concat(e.floorNumber)},"Destination"),n.a.createElement("select",{id:"FS".concat(e.floorNumber),onChange:function(t){c(t.target.value),e.onSelectFloor(t.target.value)},value:a},n.a.createElement("option",{value:"-1"},"None"),e.floors.map(function(e){return n.a.createElement("option",{key:"fo".concat(e.number),value:e.number},e.name)})))}o(20);var p=-1;function h(e){var t=Object(r.useState)(null),o=Object(u.a)(t,2),a=o[0],c=o[1];return n.a.createElement("div",{className:e.debug?"ControlPanel debug":"ControlPanel"},n.a.createElement(d,{floorNumber:e.floorNumber,floors:e.floors,selectedFloor:p,onSelectFloor:c,debug:e.debug}),n.a.createElement(E,{floorNumber:e.floorNumber,onCallElevator:function(){var t=e.floorNumber,o=a;console.log("Elevator called: from: ",t,"to: ",o),b.callElevator(t,o).then(function(e){console.log("onCallElevator: success: ",e)}).catch(function(e){console.error("onCallElevator: ",e)})},debug:e.debug}))}o(21);function g(e){return n.a.createElement("div",{className:e.debug?"Floor debug":"Floor"},n.a.createElement("div",{className:e.debug?"Floor-Name debug":"Floor-Name"},n.a.createElement("h4",null,e.floorName)),n.a.createElement(h,{debug:e.debug,floors:e.floors,floorNumber:e.floorNumber}))}o(22);function N(e){var t=Object(r.useState)(0),o=Object(u.a)(t,2),a=o[0],c=o[1];Object(r.useEffect)(function(){b.getElevator(e.elevatorID).then(function(e){c(e.currentFloor.number)}).catch(function(e){console.error("getElevator: ",e)})},[e.elevatorID]),Object(r.useEffect)(function(){b.watchElevator("E"+e.elevatorID,function(e){console.log("watchElevator: ",e),c(e.currentFloor.number)}).then(function(e){console.log("watching elevator: ",e)}).catch(function(e){console.error("watchElevator: ",e)})},[e.elevatorID]);var l=e.floors.map(function(t){return a===t.number?n.a.createElement("div",{id:"EF".concat(t.number),className:e.debug?"Elevator debug":"Elevator",key:t.number},n.a.createElement("h4",null,"E",e.elevatorID),n.a.createElement("h6",null,"Floor ",a)):n.a.createElement("div",{id:"EF".concat(t.number),className:e.debug?"Elevator-Stub debug":"Elevator-Stub",key:t.number})});return n.a.createElement("div",{className:e.debug?"Elevator-Line debug":"Elevator-Line"},l)}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(n.a.createElement(function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),o=t[0],a=t[1];return Object(r.useEffect)(function(){b.listFloors().then(a).catch(function(e){console.error("listFloors: ",e)})},[]),n.a.createElement("div",{className:"App"},n.a.createElement("h1",{className:"App-Header"},"Elevator"),n.a.createElement("div",{className:"Building"},n.a.createElement("div",{className:"Floors"},o.reverse().map(function(e){return n.a.createElement(g,{key:"f".concat(e.number),floors:o,floorName:e.name,floorNumber:e.number,debug:!1})})),n.a.createElement("div",{className:"Elevators"},Object(l.a)(Array(3).keys()).map(function(e){return n.a.createElement(N,{key:"E"+e,elevatorID:e,debug:!1,floors:o})}))))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[9,1,2]]]);
//# sourceMappingURL=main.2afcb424.chunk.js.map